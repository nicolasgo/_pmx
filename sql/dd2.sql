set @_enddate=(select date('2013-02-01'));
set @_startdate=(select date('2013-01-01'));

create table zzlg301 select * from smp_usage_log where time>@_startdate and time<@_enddate and action <> 17;

SELECT count(*) as regUsers, count(if(rel_operator_id=10,1,NULL)) as mx, count(if(rel_operator_id=18,1,NULL)) as br, count(if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM smp_user where joined < @_enddate and state=1;

SELECT count(*) as activated, count(distinct if(rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(rel_operator_id=22,msisdn,NULL)) as py FROM smp_user where joined>@_startdate and joined <@_enddate and state=1;

SELECT count(*) as activFrom_smp_user, count(distinct if(rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(rel_operator_id=22,msisdn,NULL)) as py FROM smp_user where state=1 and last_seen > @_startdate;

#SELECT count(*) as activations, count(distinct if(rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(rel_operator_id=22,msisdn,NULL)) as py FROM zzlog12 where action= 7;
SELECT miscstr3 as SMSoMMS,count(*) as AMX, count( if(rel_operator_id=10,1,NULL)) as mx, count( if(rel_operator_id=18,1,NULL)) as br, count( if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM zzlog12 where action= 16 group by miscstr3;
SELECT miscstr3 as Uploads,count(*) as AMX, count( if(rel_operator_id=10,1,NULL)) as mx, count( if(rel_operator_id=18,1,NULL)) as br, count( if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM zzlog12 where action= 3 group by miscstr3;
SELECT count(distinct msisdn) as MAU, count(distinct if(u.rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(u.rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(u.rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(u.rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(u.rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(u.rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(u.rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(u.rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(u.rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(u.rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(u.rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(u.rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(u.rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(u.rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(u.rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(u.rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(u.rel_operator_id=22,msisdn,NULL)) as py FROM zzlog12 left join smp_user as u using(msisdn) where u.state=1;
SELECT count(*) as wapUpload, count(if(rel_operator_id=10,1,NULL)) as mx, count(if(rel_operator_id=18,1,NULL)) as br, count(if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM zzlog12 where miscstr3= 'mobile';
SELECT count(*) as wapPresence, count(if(rel_operator_id=10,1,NULL)) as mx, count(if(rel_operator_id=18,1,NULL)) as br, count(if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM zzlog12 where action= 2 AND miscstr3= 'mobile' AND miscid1= 0 ;
SELECT count(distinct msisdn) as wapMAU, count(distinct if(rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(rel_operator_id=22,msisdn,NULL)) as py FROM zzlog12 where miscstr3= 'mobile' ; 
SELECT miscstr3 as MMSPending,count(distinct msisdn) as AMX, count(distinct if(u.rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(u.rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(u.rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(u.rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(u.rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(u.rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(u.rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(u.rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(u.rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(u.rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(u.rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(u.rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(u.rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(u.rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(u.rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(u.rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(u.rel_operator_id=22,msisdn,NULL)) as py FROM zzlog12 left join smp_user as u using(msisdn) where action= 16 and u.state=0;
SELECT count(*) as sbPosts, count(if(rel_operator_id=10,1,NULL)) as mx, count(if(rel_operator_id=18,1,NULL)) as br, count(if(rel_operator_id=20,1,NULL)) as ar, count(if(rel_operator_id=19,1,NULL)) as pe, count(if(rel_operator_id=24,1,NULL)) as cl, count(if(rel_operator_id=16,1,NULL)) as pa, count(if(rel_operator_id=14,1,NULL)) as do, count(if(rel_operator_id=15,1,NULL)) as co, count(if(rel_operator_id=26,1,NULL)) as gt, count(if(rel_operator_id=29,1,NULL)) as hn, count(if(rel_operator_id=27,1,NULL)) as sv, count(if(rel_operator_id=30,1,NULL)) as ni, count(if(rel_operator_id=31,1,NULL)) as pr, count(if(rel_operator_id=33,1,NULL)) as cr, count(if(rel_operator_id=21,1,NULL)) as ec, count(if(rel_operator_id=23,1,NULL)) as ur, count(if(rel_operator_id=22,1,NULL)) as py FROM zzlog12 where action=10 AND miscstr3= 'sb';
SELECT count(distinct msisdn) as sbMAU, count(distinct if(rel_operator_id=10,msisdn,NULL)) as mx, count(distinct if(rel_operator_id=18,msisdn,NULL)) as br, count(distinct if(rel_operator_id=20,msisdn,NULL)) as ar, count(distinct if(rel_operator_id=19,msisdn,NULL)) as pe, count(distinct if(rel_operator_id=24,msisdn,NULL)) as cl, count(distinct if(rel_operator_id=16,msisdn,NULL)) as pa, count(distinct if(rel_operator_id=14,msisdn,NULL)) as do, count(distinct if(rel_operator_id=15,msisdn,NULL)) as co, count(distinct if(rel_operator_id=26,msisdn,NULL)) as gt, count(distinct if(rel_operator_id=29,msisdn,NULL)) as hn, count(distinct if(rel_operator_id=27,msisdn,NULL)) as sv, count(distinct if(rel_operator_id=30,msisdn,NULL)) as ni, count(distinct if(rel_operator_id=31,msisdn,NULL)) as pr, count(distinct if(rel_operator_id=33,msisdn,NULL)) as cr, count(distinct if(rel_operator_id=21,msisdn,NULL)) as ec, count(distinct if(rel_operator_id=23,msisdn,NULL)) as ur, count(distinct if(rel_operator_id=22,msisdn,NULL)) as py FROM zzlog12 where action IN (9, 10, 11, 12) AND miscstr3= 'sb';



